{"padTitle":"Blown up",
"positions":{"map":{"__map":true,
"values":[["0",{"height":128.44559421444825,
"id":"0",
"type":"move",
"width":526.3971727684111,
"x":-561.6762611860096,
"y":820.429681462952}],["1",{"height":120,
"id":"1",
"type":"move",
"width":541.1742213223247,
"x":-582.740414977972,
"y":1023.5121350448037}],["2",{"height":123.04940894536159,
"id":"2",
"type":"move",
"width":645.5338067798932,
"x":-572.5086258842283,
"y":1237.424525924008}],["3",{"height":120,
"id":"3",
"type":"move",
"width":670.0403262179639,
"x":1222.0411470307495,
"y":2015.6624778933947}],["4",{"height":120,
"id":"4",
"type":"move",
"width":640.5129702098109,
"x":1276.4720876530725,
"y":1562.7420183382353}],["5",{"height":120,
"id":"5",
"type":"move",
"width":708.8761673916222,
"x":1267.2004903468533,
"y":1118.5924860663486}],["6",{"height":120,
"id":"6",
"type":"move",
"width":712.0689514540854,
"x":1279.2260645859506,
"y":1337.8637174046885}],["7",{"height":120,
"id":"7",
"type":"move",
"width":483.33956280356415,
"x":1256.6958966296334,
"y":868.7104382897631}],["8",{"height":120,
"id":"8",
"type":"move",
"width":346.20942323749864,
"x":691.2031605316693,
"y":3069.6927439139745}],["9",{"height":192.72779030671936,
"id":"9",
"type":"move",
"width":785.1704412767738,
"x":1109.1796820126665,
"y":3490.957203575156}],["10",{"height":325.5379287983593,
"id":"10",
"type":"move",
"width":684.641817131502,
"x":2735.2969444049304,
"y":2866.9768426217443}],["11",{"height":645.1141692143291,
"id":"11",
"type":"move",
"width":768.3559651960427,
"x":3721.3639993408647,
"y":2287.6281784884295}],["12",{"height":120,
"id":"12",
"type":"move",
"width":565.7256576716245,
"x":632.4188656620709,
"y":-716.7821642645098}],["13",{"height":120,
"id":"13",
"type":"move",
"width":590.774621381137,
"x":548.6886934055128,
"y":854.6639310979194}],["14",{"height":120,
"id":"14",
"type":"move",
"width":526.0254695812386,
"x":67.53421156392204,
"y":-526.3230320761796}],["15",{"height":120,
"id":"15",
"type":"move",
"width":514.4937658528629,
"x":75.84678621695957,
"y":-733.487596653664}],["16",{"height":120,
"id":"16",
"type":"move",
"width":497.8372655402032,
"x":78.72591163088762,
"y":-947.9625758831781}],["17",{"height":120,
"id":"17",
"type":"move",
"width":787.1513049807763,
"x":1045.9178320010922,
"y":365.3703885241599}],["18",{"height":120,
"id":"18",
"type":"move",
"width":387.3472411162931,
"x":2339.014724440871,
"y":995.2011009979728}],["19",{"height":120,
"id":"19",
"type":"move",
"width":702.1162376580717,
"x":453.3568353100664,
"y":1071.4241854181134}],["20",{"height":120,
"id":"20",
"type":"move",
"width":788.4335812521722,
"x":144.60691898731255,
"y":352.6206643083283}],["21",{"height":120,
"id":"21",
"type":"move",
"width":310.0908414668368,
"x":1253.081844622551,
"y":70.11283182794114}],["22",{"height":152.7441091786199,
"id":"22",
"type":"move",
"width":336.1647313508884,
"x":2856.3069566944723,
"y":982.8256745369633}],["23",{"height":134.50804600489192,
"id":"23",
"type":"move",
"width":273.43560381414795,
"x":882.7607441451075,
"y":58.739000979945445}],["24",{"height":709.8993996229693,
"id":"24",
"type":"move",
"width":675.8565798158112,
"x":3397.2416345558563,
"y":-638.8073787410632}],["25",{"height":228.61681776149197,
"id":"25",
"type":"resize",
"width":588.8895817469937,
"x":634.6358839319603,
"y":-973.7525175570038}],["26",{"height":166.55517397096273,
"id":"26",
"type":"move",
"width":462.7344481152118,
"x":1363.7230720804282,
"y":-1047.480230373968}],["27",{"height":196.83991018044466,
"id":"27",
"type":"move",
"width":610.4967142498383,
"x":519.8780037502779,
"y":566.9071660160014}],["28",{"height":134.6779069400049,
"id":"28",
"type":"move",
"width":511.93019928974377,
"x":4190.0785486774375,
"y":-648.6104057250593}],["29",{"height":120,
"id":"29",
"type":"move",
"width":292.25453731682717,
"x":1939.9129661498678,
"y":-951.7853467132563}],["30",{"height":120,
"id":"30",
"type":"move",
"width":343.0229185895422,
"x":-475.01857253858833,
"y":196.13519059425641}],["31",{"height":120,
"id":"31",
"type":"move",
"width":344.43012000366394,
"x":-480.09741175827054,
"y":400.1538723846743}],["32",{"height":120,
"id":"32",
"type":"move",
"width":339.41435090432054,
"x":-479.18038234805016,
"y":619.6031577916233}],["33",{"height":120,
"id":"33",
"type":"move",
"width":413.77750311736185,
"x":-57.397410457174914,
"y":630.5012378746073}],["34",{"height":120,
"id":"34",
"type":"move",
"width":659.8427160592598,
"x":1945.6339193927147,
"y":2973.226624760625}],["35",{"height":349.1663541207242,
"id":"35",
"type":"move",
"width":576.901427738656,
"x":2766.0243692099903,
"y":3281.137809098582}],["36",{"height":251.9667841825158,
"id":"36",
"type":"move",
"width":707.9969953050812,
"x":-973.1407191769382,
"y":-165.57932345850043}],["37",{"height":120,
"id":"37",
"type":"move",
"width":249.31233976297193,
"x":-24.122439874360907,
"y":1419.4508942913326}],["38",{"height":1098.4091918613972,
"id":"38",
"type":"move",
"width":718.2679692222162,
"x":408.85951207937455,
"y":1677.8458073442712}],["39",{"height":229.77061043367274,
"id":"39",
"type":"move",
"width":742.4956742508996,
"x":393.94199693759606,
"y":1354.8690737749703}],["40",{"height":120,
"id":"40",
"type":"move",
"width":728.3627763684158,
"x":1848.4622876021044,
"y":2727.302794858509}],["41",{"height":120,
"id":"41",
"type":"move",
"width":516.2694208375733,
"x":1839.6530176748197,
"y":2540.111356728511}],["42",{"height":120,
"id":"42",
"type":"move",
"width":322.2964807369397,
"x":1350.8348793004172,
"y":2508.152128048604}],["43",{"height":120,
"id":"43",
"type":"move",
"width":330.57861905420685,
"x":1352.9570086175054,
"y":2714.4961643628685}],["44",{"height":1649.5399732039937,
"id":"44",
"type":"move",
"width":676.6320383684383,
"x":-361.8567218431886,
"y":1676.587185239932}],["45",{"height":250.47829009393593,
"id":"45",
"type":"move",
"width":450.79255967053336,
"x":4202.835953136433,
"y":-374.0288713787255}],["46",{"height":1669.597499242534,
"id":"46",
"type":"resize",
"width":1093.6570570395988,
"x":4911.059250343689,
"y":-922.898232625952}],["47",{"height":147.22262364585265,
"id":"47",
"type":"move",
"width":1254.9652496807867,
"x":4742.2803484514225,
"y":-1188.278747229613}],["48",{"height":120,
"id":"48",
"type":"resize",
"width":600.9508418147562,
"x":4967.02478445604,
"y":-1448.0196823616284}],["49",{"height":120,
"id":"49",
"type":"resize",
"width":301.34818670085144,
"x":3606.9699436146984,
"y":1716.7136182966626}],["50",{"height":464.8712720637973,
"id":"50",
"type":"move",
"width":807.5208026612387,
"x":4929.100992026459,
"y":891.1345141874865}],["51",{"height":447.7139826965666,
"id":"51",
"type":"move",
"width":623.6607782656174,
"x":2135.3590996276207,
"y":1968.2234545015394}],["52",{"height":165.4490717237712,
"id":"52",
"type":"resize",
"width":520.4147209924521,
"x":2944.634777241192,
"y":1498.1991469660397}],["53",{"height":570.3900658178778,
"id":"53",
"type":"move",
"width":483.1964138266968,
"x":2967.3083975002132,
"y":2224.830966169118}],["54",{"height":120,
"id":"54",
"type":"move",
"width":631.2286146693115,
"x":3688.753520528289,
"y":2034.4824191396035}],["55",{"height":6360.217952128187,
"id":"55",
"type":"move",
"width":1304.567973780568,
"x":6154.332631153837,
"y":-1610.5174152603586}],["56",{"height":200,
"id":"56",
"type":"move",
"width":300,
"x":7501.9379138829945,
"y":-1555.381980935873}],["57",{"height":1491.351063908992,
"id":"57",
"type":"move",
"width":1318.3646466376676,
"x":4550.883495420787,
"y":1447.4781922855823}],["58",{"height":342.68502919911367,
"id":"58",
"type":"move",
"width":1309.9641850947833,
"x":3811.424191517826,
"y":3108.211241185335}],["59",{"height":120,
"id":"59",
"type":"move",
"width":282.2252495188056,
"x":4211.784643601129,
"y":541.4188540982946}],["60",{"height":120,
"id":"60",
"type":"move",
"width":346.75197721699107,
"x":4179.680532224497,
"y":310.20904438723306}],["61",{"height":695.4309470859957,
"id":"61",
"type":"move",
"width":660.7589475262894,
"x":5167.024639252835,
"y":3116.19616166188}],["62",{"height":120,
"id":"62",
"type":"move",
"width":549.0733832865392,
"x":4202.610641035705,
"y":41.75320131100392}],["63",{"height":213.86753911690798,
"id":"63",
"type":"move",
"width":563.3115362522667,
"x":-84.660320979582,
"y":-1532.5744024074586}],["64",{"height":416.9836751973689,
"id":"64",
"type":"move",
"width":484.20562198771097,
"x":1892.5550760610217,
"y":-1561.695616009596}],["65",{"height":752.0678072471383,
"id":"65",
"type":"move",
"width":653.3586332563336,
"x":2424.924934676257,
"y":-1551.6713282353087}],["66",{"height":250.8625076115823,
"id":"66",
"type":"move",
"width":307.2150704401911,
"x":1895.93257196426,
"y":-1869.5323337808552}],["67",{"height":623.8755012694085,
"id":"67",
"type":"move",
"width":531.1774742924994,
"x":3836.1598824670773,
"y":-1550.1483944323115}],["68",{"height":433.8406666965615,
"id":"68",
"type":"move",
"width":606.1439385056949,
"x":1229.7911382329244,
"y":-1536.4630150202986}],["69",{"height":467.5973244847519,
"id":"69",
"type":"move",
"width":536.6441381123491,
"x":637.4970230820104,
"y":-1552.4864427149128}],["70",{"height":713.518917899524,
"id":"70",
"type":"move",
"width":627.028184804746,
"x":3139.031525487563,
"y":-1545.5705600926565}],["71",{"height":120,
"id":"71",
"type":"move",
"width":294.0150648145341,
"x":-958.3396568006624,
"y":-600.8931381962593}],["72",{"height":197.26214991306034,
"id":"72",
"type":"move",
"width":583.1925465213038,
"x":24.147257345891276,
"y":-323.29431033811096}],["73",{"height":120,
"id":"73",
"type":"move",
"width":740.8676695355839,
"x":-97.82105090454132,
"y":1.8545851442572143}],["74",{"height":228.13975890800825,
"id":"74",
"type":"move",
"width":433.1810919222189,
"x":1445.2968423122359,
"y":3125.5609876718254}],["75",{"height":184.8989523421843,
"id":"75",
"type":"move",
"width":347.1230749094792,
"x":1389.8280315346617,
"y":-652.5417981399567}],["76",{"height":179.86195110671008,
"id":"76",
"type":"move",
"width":648.4164771578469,
"x":671.9159316443369,
"y":-540.8998620709041}],["77",{"height":133.18259534658614,
"id":"77",
"type":"move",
"width":509.079214451452,
"x":809.3080896029729,
"y":-250.87696271972084}],["78",{"height":120,
"id":"78",
"type":"move",
"width":509.91619752078157,
"x":-964.9907390369185,
"y":-1368.3815862323738}],["79",{"height":532.897106711953,
"id":"79",
"type":"move",
"width":768.9319565327538,
"x":-953.7966593956585,
"y":-1184.5352236053634}],["80",{"height":861.1506448549927,
"id":"80",
"type":"move",
"width":647.0908039738443,
"x":3419.5184093602647,
"y":286.2568486880306}],["81",{"height":120,
"id":"81",
"type":"move",
"width":398.9153678690286,
"x":4194.236051384124,
"y":900.7019247685741}],["82",{"height":220.3144734495367,
"id":"82",
"type":"move",
"width":579.3353370457525,
"x":2149.350453567677,
"y":1604.4874677326425}],["83",{"height":186.83512958303177,
"id":"83",
"type":"move",
"width":963.832871848338,
"x":3305.616739961814,
"y":1204.1086130121853}],["84",{"height":120,
"id":"84",
"type":"move",
"width":367.22224963973434,
"x":3078.342098745104,
"y":1967.9897383087398}],["85",{"height":1388.797427754327,
"id":"85",
"type":"move",
"width":647.0705543834573,
"x":2671.5721649695074,
"y":-608.0440614677193}],["86",{"height":1331.595119229716,
"id":"86",
"type":"move",
"width":649.2233811481225,
"x":1905.4914246181152,
"y":-599.8936923035051}]]}},
"titles":{"map":{"__map":true,
"values":[["0",{"id":"0",
"state":false,
"title":"addCode"}],["1",{"id":"1",
"state":false,
"title":"addRunner"}],["2",{"id":"2",
"state":false,
"title":"save"}],["3",{"id":"3",
"state":false,
"title":"load"}],["4",{"id":"4",
"state":false,
"title":"home"}],["5",{"id":"5",
"state":false,
"title":"zoomIn"}],["6",{"id":"6",
"state":false,
"title":"zoomOut"}],["7",{"id":"7",
"state":false,
"title":"navigationAction"}],["8",{"id":"8",
"state":false,
"title":"padViewChange"}],["9",{"id":"9",
"state":false,
"title":"_padViewUpdate"}],["10",{"id":"10",
"state":false,
"title":"wheel"}],["11",{"id":"11",
"state":false,
"title":"_handleWheel"}],["12",{"id":"12",
"state":false,
"title":"_1_0"}],["13",{"id":"13",
"state":false,
"title":"_1_0"}],["14",{"id":"14",
"state":false,
"title":"_1_0"}],["15",{"id":"15",
"state":false,
"title":"_1_0"}],["16",{"id":"16",
"state":false,
"title":"_1_0"}],["17",{"id":"17",
"state":false,
"title":"isSafari"}],["18",{"id":"18",
"state":false,
"title":"isMobile"}],["19",{"id":"19",
"state":false,
"title":"pointercancel"}],["20",{"id":"20",
"state":false,
"title":"lostpointercapture"}],["21",{"id":"21",
"state":false,
"title":"preventDefault"}],["22",{"id":"22",
"state":false,
"title":"preventDefaultSafari"}],["23",{"id":"23",
"state":false,
"title":"pointerLost"}],["24",{"id":"24",
"state":false,
"title":"_handleNavigationAction"}],["25",{"id":"25",
"state":false,
"title":"showGraph"}],["26",{"id":"26",
"state":false,
"title":"1"}],["27",{"id":"27",
"state":false,
"title":"_onRun"}],["28",{"id":"28",
"state":false,
"title":"_onInspect"}],["29",{"id":"29",
"state":false,
"title":"remove"}],["30",{"id":"30",
"state":false,
"title":"titleEditChange"}],["31",{"id":"31",
"state":false,
"title":"enabledChange"}],["32",{"id":"32",
"state":false,
"title":"runRequest"}],["33",{"id":"33",
"state":false,
"title":"inspectRequest"}],["34",{"id":"34",
"state":false,
"title":"dblClick"}],["35",{"id":"35",
"state":false,
"title":"_goTo"}],["36",{"id":"36",
"state":false,
"title":"rawPadDown"}],["37",{"id":"37",
"state":false,
"title":"evCache"}],["38",{"id":"38",
"state":false,
"title":"padDown"}],["39",{"id":"39",
"state":false,
"title":"padUp"}],["40",{"id":"40",
"state":false,
"title":"downOrUpOrResize"}],["41",{"id":"41",
"state":false,
"title":"_padMove"}],["42",{"id":"42",
"state":false,
"title":"windowResize"}],["43",{"id":"43",
"state":false,
"title":"moveOrResize"}],["44",{"id":"44",
"state":false,
"title":"moveCompute"}],["45",{"id":"45",
"state":false,
"title":"inputHandler"}],["46",{"id":"46",
"state":false,
"title":"windowDOM"}],["47",{"id":"47",
"state":false,
"title":"windowElements"}],["48",{"id":"48",
"state":false,
"title":"_windowRender"}],["49",{"id":"49",
"state":false,
"title":"loadRequest"}],["50",{"id":"50",
"state":false,
"title":"_saver2"}],["51",{"id":"51",
"state":false,
"title":"_loader"}],["52",{"id":"52",
"state":false,
"title":"nameFromUrl"}],["53",{"id":"53",
"state":false,
"title":"loadData"}],["54",{"id":"54",
"state":false,
"title":"_loadFromUrl"}],["55",{"id":"55",
"state":false,
"title":"css"}],["56",{"id":"56",
"state":false,
"title":"1"}],["57",{"id":"57",
"state":false,
"title":"analyzed"}],["58",{"id":"58",
"state":false,
"title":"line"}],["59",{"id":"59",
"state":false,
"title":"hovered"}],["60",{"id":"60",
"state":false,
"title":"hoveredB"}],["61",{"id":"61",
"state":false,
"title":"graph"}],["62",{"id":"62",
"state":false,
"title":"_graphRender"}],["63",{"id":"63",
"state":false,
"title":"windows"}],["64",{"id":"64",
"state":false,
"title":"windowTypes"}],["65",{"id":"65",
"state":false,
"title":"positions"}],["66",{"id":"66",
"state":false,
"title":"findMax"}],["67",{"id":"67",
"state":false,
"title":"zIndex"}],["68",{"id":"68",
"state":false,
"title":"titles"}],["69",{"id":"69",
"state":false,
"title":"windowEnabled"}],["70",{"id":"70",
"state":false,
"title":"windowContents"}],["71",{"id":"71",
"state":false,
"title":"init"}],["72",{"id":"72",
"state":false,
"title":"newId"}],["73",{"id":"73",
"state":false,
"title":"newWindowRequest"}],["74",{"id":"74",
"state":false,
"title":"padView"}],["75",{"id":"75",
"state":false,
"title":"padTitle"}],["76",{"id":"76",
"state":false,
"title":"titleChange"}],["77",{"id":"77",
"state":false,
"title":"_padTitleUpdater"}],["78",{"id":"78",
"state":false,
"title":"render"}],["79",{"id":"79",
"state":false,
"title":"renkon"}],["80",{"id":"80",
"state":false,
"title":"stringifyInner"}],["81",{"id":"81",
"state":false,
"title":"stringify"}],["82",{"id":"82",
"state":false,
"title":"parse"}],["83",{"id":"83",
"state":false,
"title":"stringifyCodeMap"}],["84",{"id":"84",
"state":false,
"title":"parseCodeMap"}],["85",{"id":"85",
"state":false,
"title":"newEditor"}],["86",{"id":"86",
"state":false,
"title":"newRunner"}]]}},
"version":2,
"windowEnabled":{"map":{"__map":true,
"values":[["0",{"enabled":true,
"id":"0"}],["1",{"enabled":true,
"id":"1"}],["2",{"enabled":true,
"id":"2"}],["3",{"enabled":true,
"id":"3"}],["4",{"enabled":true,
"id":"4"}],["5",{"enabled":true,
"id":"5"}],["6",{"enabled":true,
"id":"6"}],["7",{"enabled":true,
"id":"7"}],["8",{"enabled":true,
"id":"8"}],["9",{"enabled":true,
"id":"9"}],["10",{"enabled":true,
"id":"10"}],["11",{"enabled":true,
"id":"11"}],["12",{"enabled":true,
"id":"12"}],["13",{"enabled":true,
"id":"13"}],["14",{"enabled":true,
"id":"14"}],["15",{"enabled":true,
"id":"15"}],["16",{"enabled":true,
"id":"16"}],["17",{"enabled":true,
"id":"17"}],["18",{"enabled":true,
"id":"18"}],["19",{"enabled":true,
"id":"19"}],["20",{"enabled":true,
"id":"20"}],["21",{"enabled":true,
"id":"21"}],["22",{"enabled":true,
"id":"22"}],["23",{"enabled":true,
"id":"23"}],["24",{"enabled":true,
"id":"24"}],["25",{"enabled":true,
"id":"25"}],["26",{"enabled":true,
"id":"26"}],["27",{"enabled":true,
"id":"27"}],["28",{"enabled":true,
"id":"28"}],["29",{"enabled":true,
"id":"29"}],["30",{"enabled":true,
"id":"30"}],["31",{"enabled":true,
"id":"31"}],["32",{"enabled":true,
"id":"32"}],["33",{"enabled":true,
"id":"33"}],["34",{"enabled":true,
"id":"34"}],["35",{"enabled":true,
"id":"35"}],["36",{"enabled":true,
"id":"36"}],["37",{"enabled":true,
"id":"37"}],["38",{"enabled":true,
"id":"38"}],["39",{"enabled":true,
"id":"39"}],["40",{"enabled":true,
"id":"40"}],["41",{"enabled":true,
"id":"41"}],["42",{"enabled":true,
"id":"42"}],["43",{"enabled":true,
"id":"43"}],["44",{"enabled":true,
"id":"44"}],["45",{"enabled":true,
"id":"45"}],["46",{"enabled":true,
"id":"46"}],["47",{"enabled":true,
"id":"47"}],["48",{"enabled":true,
"id":"48"}],["49",{"enabled":true,
"id":"49"}],["50",{"enabled":true,
"id":"50"}],["51",{"enabled":true,
"id":"51"}],["52",{"enabled":true,
"id":"52"}],["53",{"enabled":true,
"id":"53"}],["54",{"enabled":true,
"id":"54"}],["55",{"enabled":true,
"id":"55"}],["56",{"enabled":true,
"id":"56"}],["57",{"enabled":true,
"id":"57"}],["58",{"enabled":true,
"id":"58"}],["59",{"enabled":true,
"id":"59"}],["60",{"enabled":true,
"id":"60"}],["61",{"enabled":true,
"id":"61"}],["62",{"enabled":true,
"id":"62"}],["63",{"enabled":true,
"id":"63"}],["64",{"enabled":true,
"id":"64"}],["65",{"enabled":true,
"id":"65"}],["66",{"enabled":true,
"id":"66"}],["67",{"enabled":true,
"id":"67"}],["68",{"enabled":true,
"id":"68"}],["69",{"enabled":true,
"id":"69"}],["70",{"enabled":true,
"id":"70"}],["71",{"enabled":true,
"id":"71"}],["72",{"enabled":true,
"id":"72"}],["73",{"enabled":true,
"id":"73"}],["74",{"enabled":true,
"id":"74"}],["75",{"enabled":true,
"id":"75"}],["76",{"enabled":true,
"id":"76"}],["77",{"enabled":true,
"id":"77"}],["78",{"enabled":true,
"id":"78"}],["79",{"enabled":true,
"id":"79"}],["80",{"enabled":true,
"id":"80"}],["81",{"enabled":true,
"id":"81"}],["82",{"enabled":true,
"id":"82"}],["83",{"enabled":true,
"id":"83"}],["84",{"enabled":true,
"id":"84"}],["85",{"enabled":true,
"id":"85"}],["86",{"enabled":true,
"id":"86"}]]}},
"windowTypes":{"map":{"__map":true,
"values":[["0","code"],["1","code"],["2","code"],["3","code"],["4","code"],["5","code"],["6","code"],["7","code"],["8","code"],["9","code"],["10","code"],["11","code"],["12","code"],["13","code"],["14","code"],["15","code"],["16","code"],["17","code"],["18","code"],["19","code"],["20","code"],["21","code"],["22","code"],["23","code"],["24","code"],["25","code"],["26","code"],["27","code"],["28","code"],["29","code"],["30","code"],["31","code"],["32","code"],["33","code"],["34","code"],["35","code"],["36","code"],["37","code"],["38","code"],["39","code"],["40","code"],["41","code"],["42","code"],["43","code"],["44","code"],["45","code"],["46","code"],["47","code"],["48","code"],["49","code"],["50","code"],["51","code"],["52","code"],["53","code"],["54","code"],["55","code"],["56","code"],["57","code"],["58","code"],["59","code"],["60","code"],["61","code"],["62","code"],["63","code"],["64","code"],["65","code"],["66","code"],["67","code"],["68","code"],["69","code"],["70","code"],["71","code"],["72","code"],["73","code"],["74","code"],["75","code"],["76","code"],["77","code"],["78","code"],["79","code"],["80","code"],["81","code"],["82","code"],["83","code"],["84","code"],["85","code"],["86","code"]]}},
"windows":["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86"],
"zIndex":{"map":{"__map":true,
"values":[["0",100],["1",138],["2",170],["3",183],["4",105],["5",106],["6",103],["7",184],["8",110],["9",132],["10",108],["11",101],["12",111],["13",112],["14",120],["15",172],["16",115],["17",116],["18",119],["19",127],["20",109],["21",121],["22",171],["23",122],["24",179],["25",125],["26",124],["27",126],["28",185],["29",159],["30",117],["31",129],["32",130],["33",131],["34",135],["35",155],["36",133],["37",136],["38",143],["39",157],["40",141],["41",142],["42",140],["43",137],["44",173],["45",144],["46",160],["47",177],["48",147],["49",148],["50",145],["51",102],["52",151],["53",150],["54",152],["55",154],["56",186],["57",123],["58",158],["59",156],["60",161],["61",128],["62",162],["63",146],["64",168],["65",163],["66",165],["67",169],["68",166],["69",167],["70",164],["71",107],["72",139],["73",174],["74",178],["75",176],["76",175],["77",114],["78",134],["79",113],["80",180],["81",182],["82",149],["83",104],["84",153],["85",181],["86",118]]}}}
{__codeMap: true, value: [[`0`, `const addCode = Events.listener(renkon.querySelector("#addCodeButton"), "click", () => "code");`],
[`1`, `const addRunner = Events.listener(renkon.querySelector("#addRunnerButton"), "click", () => "runner");`],
[`2`, `const save = Events.listener(renkon.querySelector("#saveButton"), "click", (evt) => evt);`],
[`3`, `const load = Events.listener(renkon.querySelector("#loadButton"), "click", (evt) => evt);`],
[`4`, `const home = Events.listener(renkon.querySelector("#homeButton"), "click", () => "home");`],
[`5`, `const zoomIn = Events.listener(renkon.querySelector("#zoomInButton"), "click", () => "zoomIn");`],
[`6`, `const zoomOut = Events.listener(renkon.querySelector("#zoomOutButton"), "click", () => "zoomOut");`],
[`7`, `const navigationAction = Events.or(home, zoomIn, zoomOut);`],
[`8`, `const padViewChange = Events.receiver();`],
[`9`, `const _padViewUpdate = ((padView) => {
    const mover = document.querySelector("#mover");
    const pad = document.querySelector("#pad");
    mover.style.setProperty("transform", \`translate(\${padView.x}px, \${padView.y}px) scale(\${padView.scale})\`);

    pad.style.setProperty("background-position", \`\${padView.x}px \${padView.y}px\`);
    pad.style.setProperty("background-size", \`\${64 * padView.scale}px \${64 * padView.scale}px\`);
})(padView);`],
[`10`, `const wheel = Events.listener(renkon.querySelector("#pad"), "wheel", (evt) => {
    let pinch;
    if (isSafari) {
        pinch = (Number.isInteger(evt.deltaX) && !Number.isInteger(evt.deltaY)) || evt.metaKey;
    } else {
        pinch = evt.ctrlKey || evt.metaKey;
    }
    const strId = evt.target.id;
    if (pinch) {
        evt.preventDefault();
        if (strId === "pad") {
            evt.stopPropagation();
        }
    }
    return evt;
});`],
[`11`, `const _handleWheel = ((wheel, padView) => {
    let pinch;
    if (isSafari) {
        pinch = (Number.isInteger(wheel.deltaX) && !Number.isInteger(wheel.deltaY)) || wheel.metaKey;
    } else {
        pinch = wheel.ctrlKey || wheel.metaKey;
    }
    const strId = wheel.target.id;

    let deltaX = wheel.deltaX;
    let deltaY = wheel.deltaY;
    let zoom = padView.scale;

    let absDeltaY = Math.min(30, Math.abs(deltaY));
    let diff = Math.sign(deltaY) * absDeltaY;

    let desiredZoom = zoom * (1 - diff / 200);

    const xInMover = (wheel.clientX - padView.x) / padView.scale;
    const newX = wheel.clientX - xInMover * desiredZoom;

    const yInMover = (wheel.clientY - padView.y) / padView.scale;
    const newY = wheel.clientY - yInMover * desiredZoom;

    if (strId === "pad") {
        if (pinch) {
            Events.send(padViewChange, {x: newX, y: newY, scale: desiredZoom});
        } else {
            Events.send(padViewChange, {x: padView.x - deltaX, y: padView.y - deltaY, scale: padView.scale});
        }
    }
})(wheel, padView);`],
[`12`, `Events.listener(renkon.querySelector("#buttonBox"), "wheel", preventDefault);`],
[`13`, `Events.listener(renkon.querySelector("#navigationBox"), "wheel", preventDefault);`],
[`14`, `Events.listener(document.body, "gesturestart", preventDefaultSafari);`],
[`15`, `Events.listener(document.body, "gesturechange", preventDefaultSafari);`],
[`16`, `Events.listener(document.body, "gestureend", preventDefaultSafari);`],
[`17`, `const isSafari = window.navigator.userAgent.includes("Safari") && !window.navigator.userAgent.includes("Chrome");`],
[`18`, `const isMobile = !!("ontouchstart" in window);`],
[`19`, `const pointercancel = Events.listener(renkon.querySelector("#pad"), "pointercancel", pointerLost);`],
[`20`, `const lostpointercapture = Events.listener(renkon.querySelector("#pad"), "lostpointercapture", pointerLost);`],
[`21`, `const preventDefault = (evt) => {
    evt.preventDefault();
    return evt;
};`],
[`22`, `const preventDefaultSafari = (evt) => {
    if (!isSafari || isMobile) {
        evt.preventDefault();
    }
    return evt;
};`],
[`23`, `const pointerLost = (evt) => {
    evCache.clear();
    evt.preventDefault();
    return {type: "lost"};
};`],
[`24`, `const _handleNavigationAction = ((navigationAction, positions, padView) => {
    if (navigationAction === "zoomIn") {
        Events.send(padViewChange, {x: padView.x, y: padView.y, scale: padView.scale * 1.1});
    } else if (navigationAction === "zoomOut") {
        Events.send(padViewChange, {x: padView.x, y: padView.y, scale: padView.scale * 0.9});
    } else if (navigationAction === "home") {
        let minLeft = Number.MAX_VALUE;
        let minTop = Number.MAX_VALUE;
        let maxRight = Number.MIN_VALUE;
        let maxBottom = Number.MIN_VALUE;

        if (positions.map.size === 0) {
            Events.send(padViewChange, {x: 0, y: 0, scale: 1});
            return;
        }
        for (let [_, position] of positions.map) {
            minLeft = Math.min(position.x, minLeft);
            minTop = Math.min(position.y, minTop);
            maxRight = Math.max(position.x + position.width, maxRight);
            maxBottom = Math.max(position.y + position.height, maxBottom);
        }

        const pad = document.body.querySelector("#pad").getBoundingClientRect();

        const scaleX = pad.width / (maxRight - minLeft);
        const scaleY = pad.height / (maxBottom - minTop);
        const scale = Math.min(1, scaleX, scaleY) * 0.9;

        const centerX = (maxRight + minLeft) / 2;
        const centerY = (maxBottom + minTop) / 2;

        let x = pad.width / 2 - centerX * scale;
        let y = pad.height / 2 - centerY * scale;

        Events.send(padViewChange, {x, y, scale});
    }
})(navigationAction, positions, padView);`],
[`25`, `const showGraph = Behaviors.collect(
    "showGraph",
    Events.listener(renkon.querySelector("#showGraph"), "click", (evt) => evt),
    (now, _click) => {
        if (now === "showGraph") {return "showDeps";}
        if (now === "showDeps") {return "hide";}
        if (now === "hide") {return "showGraph"}
        return now;
    }
);`],
[`26`, `((showGraph) => {
    let str;
    if (showGraph === "showGraph") {str = "show graph";}
    if (showGraph === "showDeps") {str = "show deps";}
    if (showGraph === "hide") {str = "hide graph"}
    document.querySelector("#showGraph").textContent = str;
})(showGraph);`],
[`27`, `const _onRun = ((runRequest, windowContents, windowEnabled) => {
    const id = runRequest.id;
    const iframe = windowContents.map.get(id);
    const code = [...windowContents.map]
        .filter(([id, obj]) => obj.state && windowEnabled.map.get(id).enabled)
        .map(([_id, editor]) => editor.state.doc.toString());
    iframe.dom.contentWindow.postMessage({code: code, path: id});
})(runRequest, windowContents, windowEnabled);`],
[`28`, `const _onInspect = ((inspectRequest) => {
    const id = inspectRequest.id;
    const iframe = windowContents.map.get(id);
    iframe.dom.contentWindow.postMessage({inspector: true, path: id});
})(inspectRequest);`],
[`29`, `const remove = Events.receiver();`],
[`30`, `const titleEditChange = Events.receiver();`],
[`31`, `const enabledChange = Events.receiver();`],
[`32`, `const runRequest = Events.receiver();`],
[`33`, `const inspectRequest = Events.receiver();`],
[`34`, `const dblClick = Events.listener(renkon.querySelector("#pad"), "dblclick", (evt) => evt);`],
[`35`, `const _goTo = ((padView, positions, dblClick) => {
    const strId = dblClick.target.id;
    if (!strId.endsWith("-titleBar")) {return;}
    const id = Number.parseInt(strId);
    const position = positions.map.get(\`\${id}\`);

    const pad = document.body.querySelector("#pad").getBoundingClientRect();

    const scaleX = pad.width / position.width;
    const scaleY = pad.height / position.height;
    const scale = Math.min(scaleX, scaleY) * 0.95;
    const x = pad.width / 2 - (position.x + position.width / 2) * scale;
    const y = pad.height / 2 - (position.y + position.height / 2) * scale;

    Events.send(padViewChange, {x, y, scale});
})(padView, positions, dblClick);`],
[`36`, `const rawPadDown = Events.listener(renkon.querySelector("#pad"), "pointerdown", (evt) => {
    const strId = evt.target.id;
    if (strId.endsWith("-title") && (evt.target.getAttribute("contenteditable") === "true")) {
        return evt;
    }
    if (strId) {
        evt.preventDefault();
        evt.stopPropagation();
    }
    return evt;
}, {queued: true});`],
[`37`, `const evCache = new Map();`],
[`38`, `const padDown = Events.collect(undefined, rawPadDown, (old, evts) => {
    let type;
    let id;
    if (evts.length <= 2 && evts[0].isPrimary) {
        let primary = evts[0];
        const strId = primary.target.id;
        if (!strId) {return {...old, type: ""};}
        let x = primary.clientX;
        let y = primary.clientY;
        if (strId === "pad") {
            type = "padDragDown";
            id = strId;
        } else {
            id = \`\${Number.parseInt(strId)}\`;
            if (strId.endsWith("-titleBar")) {
                type = "moveDown";
            } else if (strId.endsWith("-resize")) {
                type = "windowResizeDown";
            }
        }
        if (type) {
            primary.target.setPointerCapture(primary.pointerId);
            if (strId === "pad") {
                evCache.set("primary", {x, y});
            }
            if (evts.length === 1) {
                return {
                    id, target: primary.target, type, x: primary.clientX, y: primary.clientY
                };
            }
        } else {
            return {...old, type: ""};
        }
    }

    let secondary;
    if (evCache.get("primary")) {
        if (evts.length === 1 && evCache.size === 1 && !evts[0].isPrimary) {
            secondary = evts[0];
        }
        if (evts.length === 2 && evCache.size === 1 && !evts[1].isPrimary) {
            secondary = evts[1];
        }
    }
    if (!secondary) {return old;}

    const strId = secondary.target.id;
    if (strId !== "pad") {return {type: "stuck", secondary: secondary.pointerId};}
    let primary =  evCache.get("primary");
    let x = secondary.clientX;
    let y = secondary.clientY;
    let dx = primary.x - secondary.clientX;
    let dy = primary.y - secondary.clientY;
    let origDiff = Math.sqrt(dx * dx + dy * dy);
    evCache.set(secondary.pointerId, {origDiff, origScale: padView.scale, x, y});
    return {type: "pinch", secondary: secondary.pointerId};
});`],
[`39`, `const padUp = Events.listener(renkon.querySelector("#pad"), "pointerup", (evt) => {
    // console.log("ev1", evCache);
    evt.target.releasePointerCapture(evt.pointerId);
    evCache.clear();
    // console.log("ev2", evCache);
    return {type: "pointerup", x: evt.clientX, y: evt.clientY};
});`],
[`40`, `const downOrUpOrResize = Events.or(padDown, padUp, pointercancel, lostpointercapture, windowResize);`],
[`41`, `const _padMove = Events.listener("#pad", "pointermove", moveCompute);`],
[`42`, `const windowResize = Events.receiver();`],
[`43`, `const moveOrResize = Events.receiver();`],
[`44`, `const moveCompute = ((downOrUpOrResize, positions, padView) => {
    if (downOrUpOrResize.type === "moveDown" || downOrUpOrResize.type === "windowResizeDown") {
        const start = positions.map.get(downOrUpOrResize.id);
        const scale = padView.scale;
        const downPoint = {x: downOrUpOrResize.x, y: downOrUpOrResize.y};
        const type = downOrUpOrResize.type === "moveDown" ? "move" : "resize";
        return (move) => {
            const diffX = (move.clientX - downPoint.x) / scale;
            const diffY = (move.clientY - downPoint.y) / scale;
            const result = {id: downOrUpOrResize.id, type};
            if (type === "move") {
                result.x = start.x + diffX;
                result.y = start.y + diffY;
            } else {
                result.width = start.width + diffX;
                result.height = start.height + diffY;
            }
            Events.send(moveOrResize, result);
            return move;
        }
    } else if (downOrUpOrResize.type === "padDragDown") {
        const start = padView;
        const scale = start.scale;
        const downPoint = {x: downOrUpOrResize.x, y: downOrUpOrResize.y};
        const type = "padDrag";
        return (move) => {
            const diffX = move.clientX - downPoint.x;
            const diffY = move.clientY - downPoint.y;
            const result = {id: downOrUpOrResize.id, type, scale};
            result.x = start.x + diffX;
            result.y = start.y + diffY;
            Events.send(padViewChange, result);
            return move;
        };
    } else if (downOrUpOrResize.type === "pinch") {
        return (move) => {
            const keys = [...evCache.keys()];
            const primary = evCache.get("primary");
            if (!primary) {
                // the first finger has been lifted
                return move;
            }
            const otherKey = keys.find((k) => k !== "primary");
            const secondary = evCache.get(otherKey);
            const isPrimary = move.isPrimary;

            if (isPrimary) {
                const newRecord = {...primary};
                newRecord.x = move.clientX;
                newRecord.y = move.clientY;
                evCache.set("primary", newRecord);
            } else {
                const newRecord = {...secondary};
                newRecord.x = move.clientX;
                newRecord.y = move.clientY;
                evCache.set(otherKey, newRecord);
            }

            const origDiff = secondary.origDiff;
            const origScale = secondary.origScale;

            const pX = isPrimary ? move.clientX : primary.x;
            const pY = isPrimary ? move.clientY : primary.y;

            const sX = isPrimary ? secondary.x : move.clientX;
            const sY = isPrimary ? secondary.y : move.clientY;

            const newDiff = Math.sqrt((pX - sX) ** 2 + (pY - sY) ** 2);

            const newScale = (newDiff / origDiff) * origScale;

            const newCenterX = (pX - sX) / 2 + sX;
            const newCenterY = (pY - sY) / 2 + sY;

            const xInMover = (newCenterX - padView.x) / padView.scale;
            const newX = newCenterX - xInMover * newScale;

            const yInMover = (newCenterY - padView.y) / padView.scale;
            const newY = newCenterY - yInMover * newScale;

            Events.send(padViewChange, {x: newX, y: newY, scale: newScale});
            return move;
        }
    } else if (["pointerup", "lost", "stuck"].includes(downOrUpOrResize.type)) {
        return (move) => move;
    }
})(downOrUpOrResize, positions, padView);`],
[`45`, `const inputHandler = (evt) => {
    if (evt.key === "Enter") {
        evt.preventDefault();
        evt.stopPropagation();
        Events.send(titleEditChange, {
            id: \`\${Number.parseInt(evt.target.id)}\`,
            title: evt.target.textContent,
            state: false
        });
    }
};`],
[`46`, `const windowDOM = (id, position, zIndex, title, windowContent, type, windowEnabled) => {
    return h("div", {
        key: \`\${id}\`,
        id: \`\${id}-win\`,
        "class": "window",
        style: {
            left: \`\${position.x}px\`,
            top: \`\${position.y}px\`,
            width: \`\${position.width}px\`,
            height: \`\${position.height}px\`,
            zIndex: \`\${zIndex}\`,
        },
        ref: (ref) => {
            if (ref) {
                if (ref.querySelector(".windowHolder") !== windowContent.dom.parentNode) {
                    ref.querySelector(".windowHolder").appendChild(windowContent.dom);
                }
            }
        },
        onPointerEnter: (evt) => Events.send(hovered, \`\${Number.parseInt(evt.target.id)}\`),
        onPointerLeave: (_evt) => Events.send(hovered, null)
    }, [
        h("div", {
            id: \`\${id}-titleBar\`,
            "class": "titleBar",
        }, [
            h("div", {
                id: \`\${id}-enabledButton\`,
                disabled: !!(windowEnabled && !windowEnabled.enabled),
                style: {
                    display: \`\${type !== "code" ? "none" : "inheirt"}\`
                },
                "class": "titlebarButton enabledButton",
                onClick: (evt) => {
                    //console.log(evt);
                    Events.send(enabledChange, {id: \`\${Number.parseInt(evt.target.id)}\`, enabled: !windowEnabled || !windowEnabled.enabled});
                },
            }),
            h("div", {
                id: \`\${id}-runButton\`,
                "class": "titlebarButton runButton",
                type,
                onClick: (evt) => {
                    //console.log(evt);
                    Events.send(runRequest, {id: \`\${Number.parseInt(evt.target.id)}\`});
                },
            }),
            h("div", {
                id: \`\${id}-inspectorButton\`,
                "class": "titlebarButton inspectorButton",
                type,
                onClick: (evt) => {
                    //console.log(evt);
                    Events.send(inspectRequest, {id: \`\${Number.parseInt(evt.target.id)}\`});
                },
            }),
            h("div", {
                id: \`\${id}-title\`,
                "class": "title",
                contentEditable: \`\${title.state}\`,
                onKeydown: inputHandler,
            }, title.title),
            h("div", {
                id: \`\${id}-edit\`,
                "class": \`titlebarButton editButton\`,
                onClick: (evt) => {
                    // console.log(evt);
                    Events.send(titleEditChange, {id: \`\${Number.parseInt(evt.target.id)}\`, state: !title.state});
                },
            }, []),
            h("div", {
                id: \`\${id}-close\`,
                "class": "titlebarButton closeButton",
                onClick: (evt) => {
                    Events.send(remove, {id: \`\${Number.parseInt(evt.target.id)}\`, type: "remove"})
                }
            }),
        ]),
        h("div", {
            id: \`\${id}-resize\`,
            "class": "resizeHandler",
        }, []),
        h("div", {
            id: \`\${id}-windowHolder\`,
            blurred: \`\${type !== "code" ? false : (windowEnabled ? !windowEnabled.enabled : false)}\`,
            "class": "windowHolder",
        }, [])
    ])
};`],
[`47`, `const windowElements = ((windows, positions, zIndex, titles, windowContents, windowTypes, windowEnabled) => {
    return h("div", {id: "owner", "class": "owner"}, windows.map((id) => {
        return windowDOM(id, positions.map.get(id), zIndex.map.get(id), titles.map.get(id), windowContents.map.get(id), windowTypes.map.get(id), windowEnabled.map.get(id));
    }));
})(windows, positions, zIndex, titles, windowContents, windowTypes, windowEnabled);`],
[`48`, `const _windowRender = render(windowElements, document.querySelector("#mover"));`],
[`49`, `const loadRequest = Events.receiver();`],
[`50`, `const _saver2 = ((windows, positions, zIndex, titles, windowContents, windowTypes, padTitle, windowEnabled) => {
    const code = new Map([...windowContents.map].filter(([_id, editor]) => editor.state).map(([id, editor]) => ([id, editor.state.doc.toString()])));
    const myTitles = new Map([...titles.map].map(([id, obj]) => ([id, {...obj, state: false}])));
    const data1 = stringify({
        version: 2,
        windows,
        positions,
        zIndex,
        titles: {map: myTitles},
        windowTypes,
        padTitle,
        windowEnabled
    });

    const data2 = stringifyCodeMap(code);

    const div = document.createElement("a");
    const dataStr = "data:text/plain;charset=utf-8," + encodeURIComponent(data1) + encodeURIComponent(data2);
    div.setAttribute("href", dataStr);
    div.setAttribute("download", \`\${padTitle}.renkon\`);
    div.click();
})(windows, positions, zIndex, titles, windowContents, windowTypes, padTitle, windowEnabled, save);`],
[`51`, `const _loader = (() => {
    const input = document.createElement("div");
    input.innerHTML = \`<input id="imageinput" type="file" accept=".json,.renkon">\`;
    const imageInput = input.firstChild;

    imageInput.onchange = () => {
        const file = imageInput.files[0];
        if (!file) {imageInput.remove(); return;}
        new Promise(resolve => {
            let reader = new FileReader();
            reader.onload = () => resolve(reader.result);
            reader.readAsArrayBuffer(file);
        }).then((data) => {
            const result = new TextDecoder("utf-8").decode(data);
            loadData(result, imageInput);
        });
        imageInput.value = "";
    };
    imageInput.oncancel = () => imageInput.remove();
    document.body.appendChild(imageInput);
    imageInput.click();
})(load);`],
[`52`, `const nameFromUrl = (() => {
    const maybeUrl = new URL(window.location).searchParams.get("file");
    if (maybeUrl) {
        return maybeUrl;
    }
    return undefined;
})();`],
[`53`, `const loadData = (result, maybeImageInput) => {
    const index = result.indexOf("{__codeMap: true, value:");
    if (index < 0) {
        const loaded = parse(result);
        if (loaded.version === 1) {
            Events.send(loadRequest, loaded);
            maybeImageInput?.remvoe();
            return;
        }
        console.log("unknown type of data");
        maybeImageInput?.remvoe();
        return;
    }

    const data1 = result.slice(0, index);
    const data2 = result.slice(index);

    const loaded = parse(data1);

    if (loaded.version === 2) {
        const code = parseCodeMap(data2);
        loaded.code = code;
        Events.send(loadRequest, loaded);
        maybeImageInput?.remove();
        return;
    }
    console.log("unknown type of data");
    maybeImageInput.remove();
}`],
[`54`, `const _loadFromUrl = fetch(nameFromUrl).then((resp) => resp.text()).then((result) => {
    loadData(result, null);
});`],
[`55`, `const css = \`
@font-face {
    font-family: "OpenSans-Regular";
    src: url("./assets/fonts/open-sans-v17-latin-ext_latin-regular.woff2") format("woff2");
}

@font-face {
  font-family: 'OpenSans-SemiBold';
  src: url("./assets/fonts/open-sans-v17-latin-ext_latin-600.woff2") format('woff2');
}

html, body, #renkon {
    overflow: hidden;
    height: 100%;
    margin: 0px;
}

html, body {
  overscroll-behavior-x: none;
  touch-action: none;
}

#pad {
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0px;
    left: 0px;
    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAjElEQVR4XuXQAQ0AAAgCQfoHpYbOGt5vEODSdgovd3I+gA/gA/gAPoAP4AP4AD6AD+AD+AA+gA/gA/gAPoAP4AP4AD6AD+AD+AA+gA/gA/gAPoAP4AP4AD6AD+AD+AA+gA/gA/gAPoAP4AP4AD6AD+AD+AA+gA/gA/gAPoAP4AP4AD6AD+AD+AA+wIcWxEeefYmM2dAAAAAASUVORK5CYII=);
}

#mover {
    pointer-events: none;
    position:absolute;
    transform-origin: 0px 0px;
}

#owner {
    position: absolute;
    pointer-events: initial;
}

.editor {
    height: 100%;
    border-radius: 0px 0px 6px 6px;
}

#overlay {
    pointer-events: none;
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0px;
    left: 0px;
    z-index: 10000;
}

.window {
    position: absolute;
    background-color: #eee;
    border-radius: 6px;
    box-shadow: inset 0 2px 2px 0 rgba(255, 255, 255, 0.8), 1px 1px 8px 0 rgba(0, 35, 46, 0.2);
}

#buttonBox {
    display: flex;
    flex-wrap: wrap;
    justify-content: flex-end;
    row-gap: 8px;
    left: 0px;
    top: 0px;
    width: 100%;
    padding-bottom: 8px;
    padding-top: 8px;
    border-bottom: 1px solid black;
    background-color: white;
    position: absolute;
    z-index: 200000;
}

#padTitle {
    margin-left: 24px;
}

.spacer {
    flex-grow: 1;
}

.menuButton {
    font-family: 'OpenSans-SemiBold';
    color: black;
    margin-left: 4px;
    margin-right: 4px;
    border-radius: 4px;
    cursor: pointer;
    border: 2px solid #555;
}
                   

.runnerIframe {
    width: 100%;
    height: 100%;
    border: 2px solid black;
    box-sizing: border-box;
    border-radius: 0px 0px 6px 6px;
    background-color: #fff;
    user-select: none;
}

.titleBar {
    background-color: #bbb;
    width: 100%;
    height: 28px;
    display: flex;
    border: 2px ridge #ccc;
    box-sizing: border-box;
    border-radius: 6px 6px 0px 0px;
    cursor: -webkit-grab;
    cursor: grab;
}

.title {
    font-family: OpenSans-Regular;
    pointer-events: none;
    margin-left: 10px;
    flex-grow: 1;
    margin-right: 20px;
    padding-left: 10px;
}

.title[contentEditable="true"] {
    background-color: #eee;
    pointer-events: all;
    user-select: all;
}

.titlebarButton {
    height: 19px;
    width: 19px;
    margin: 2px;
    margin-top: 2px;
    pointer-events: all;
    border-radius: 4px;
    background-position: center;
    cursor: pointer;
}

.titlebarButton:hover {
    background-color: #eee;
}

.closeButton {
    background-image: url("data:image/svg+xml,%3Csvg%20id%3D%22Layer_1%22%20data-name%3D%22Layer%201%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%3E%3Cpath%20d%3D%22M8.48%2C12.25C6.4%2C10.17%2C4.37%2C8.16%2C2.35%2C6.15c-.34-.34-.68-.69-1-1.05a2.34%2C2.34%2C0%2C0%2C1%2C.17-3.26%2C2.3%2C2.3%2C0%2C0%2C1%2C3.25-.09C7%2C3.93%2C9.23%2C6.14%2C11.45%2C8.34a5.83%2C5.83%2C0%2C0%2C1%2C.43.58c.36-.4.62-.71.9-1%2C2-2%2C4.12-4%2C6.12-6.08a2.51%2C2.51%2C0%2C0%2C1%2C3.41%2C0%2C2.37%2C2.37%2C0%2C0%2C1%2C0%2C3.43c-2.18%2C2.22-4.39%2C4.41-6.58%2C6.62-.11.1-.21.22-.34.35l.44.48L22.09%2C19A2.7%2C2.7%2C0%2C0%2C1%2C23%2C20.56a2.49%2C2.49%2C0%2C0%2C1-1.29%2C2.54A2.36%2C2.36%2C0%2C0%2C1%2C19%2C22.69c-2-2-4-4-6.06-6-.33-.33-.62-.68-1-1.12-1.63%2C1.66-3.17%2C3.25-4.73%2C4.82-.79.8-1.6%2C1.59-2.42%2C2.36a2.32%2C2.32%2C0%2C0%2C1-3.21-.1%2C2.3%2C2.3%2C0%2C0%2C1-.19-3.25c2.14-2.2%2C4.31-4.36%2C6.48-6.54Z%22%20fill%3D%22%234D4D4D%22%2F%3E%3C%2Fsvg%3E");
}

.editButton {
    background-image: url("data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3Csvg%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%220%200%2024%2024%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3C!--%20Generator%3A%20Sketch%2064%20(93537)%20-%20https%3A%2F%2Fsketch.com%20--%3E%3Ctitle%3Eicon%2Fmaterial%2Fedit%3C%2Ftitle%3E%3Cdesc%3ECreated%20with%20Sketch.%3C%2Fdesc%3E%3Cg%20id%3D%22icon%2Fmaterial%2Fedit%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22ic-round-edit%22%3E%3Cg%20id%3D%22Icon%22%20fill%3D%22%234D4D4D%22%3E%3Cpath%20d%3D%22M3%2C17.46%20L3%2C20.5%20C3%2C20.78%203.22%2C21%203.5%2C21%20L6.54%2C21%20C6.67%2C21%206.8%2C20.95%206.89%2C20.85%20L17.81%2C9.94%20L14.06%2C6.19%20L3.15%2C17.1%20C3.05%2C17.2%203%2C17.32%203%2C17.46%20Z%20M20.71%2C7.04%20C20.8972281%2C6.85315541%2021.002444%2C6.59950947%2021.002444%2C6.335%20C21.002444%2C6.07049053%2020.8972281%2C5.81684459%2020.71%2C5.63%20L18.37%2C3.29%20C18.1831554%2C3.10277191%2017.9295095%2C2.99755597%2017.665%2C2.99755597%20C17.4004905%2C2.99755597%2017.1468446%2C3.10277191%2016.96%2C3.29%20L15.13%2C5.12%20L18.88%2C8.87%20L20.71%2C7.04%20Z%22%20id%3D%22Icon-Shape%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3Crect%20id%3D%22ViewBox%22%20fill-rule%3D%22nonzero%22%20x%3D%220%22%20y%3D%220%22%20width%3D%2224%22%20height%3D%2224%22%3E%3C%2Frect%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
}

.runButton {
    background-image: url("data:image/svg+xml,%3Csvg%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20stroke%3D%22%234D4D4D%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3C!--%20Box%20outline%20--%3E%3Crect%20x%3D%223%22%20y%3D%223%22%20width%3D%2218%22%20height%3D%2218%22%20rx%3D%222%22%20ry%3D%222%22%2F%3E%3C!--%20Right-pointing%20triangle%20(play%20icon)%20--%3E%3Cpath%20d%3D%22M9%207L17%2012L9%2017Z%22%20fill%3D%22%234D4D4D%22%20stroke%3D%22none%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E");
    display: none;
    pointer-events: none;
}

.runButton[type="runner"] {
    display: inherit;
    pointer-events: all;
}

.resizeHandler {
    position: absolute;
    background-color: rgba(0.1, 0.1, 0.1, 0.1);
    width: 20px;
    height: 20px;
    bottom: -10px;
    right: -10px;
    border-radius: 6px;
    z-index: 10000;
    cursor: se-resize;
}

.resizeHandler:hover {
    background-color: rgba(0.1, 0.4, 0.1, 0.3);
}

.windowHolder {
    height: calc(100% - 24px);
}

.windowHolder[blurred="true"] {
    filter: blur(4px)
}

#navigationBox {
    display: flex;
    flex-direction: column;
    right: 20px;
    gap: 10px;
    bottom: 80px;
    align-items: center;
    width: 40px;
    border: 1px solid black;
    background-color: #d2d2d2;
    position: absolute;
    z-index: 200000;
    border-radius: 8px;
    box-shadow: 4px 5px 8px -2px rgba(0,0,0,.15);
}

.navigationButton {
    width: 30px;
    height: 30px;
    display: flex;
    cursor: pointer;
}

.with-border {
    border: 1px solid #4D4D4D;
    border-radius: 15px;
    background-color: white;
}

.navigationButton:hover {
    background-color: #eaeaea;
}

.navigationButton:first-child {
    margin-top: 10px;
}

.navigationButton:last-child {
    margin-bottom: 10px;
}

.navigationButtonImage {
    width: 100%;
    height: 100%;
    background-position: center;
    background-repeat: no-repeat;
}

#zoomInButton {
    background-image: url("data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3Csvg%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%220%200%2024%2024%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%3Eicon%2Fmaterial%2Fview_zoom-in%3C%2Ftitle%3E%3Cg%20id%3D%22icon%2Fmaterial%2Fview_zoom-in%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22ic-baseline-add%22%3E%3Cg%20id%3D%22Icon%22%20fill%3D%22%234D4D4D%22%3E%3Cpolygon%20id%3D%22Icon-Path%22%20points%3D%2219%2013%2013%2013%2013%2019%2011%2019%2011%2013%205%2013%205%2011%2011%2011%2011%205%2013%205%2013%2011%2019%2011%22%3E%3C%2Fpolygon%3E%3C%2Fg%3E%3Crect%20id%3D%22ViewBox%22%20fill-rule%3D%22nonzero%22%20x%3D%220%22%20y%3D%220%22%20width%3D%2224%22%20height%3D%2224%22%3E%3C%2Frect%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
}

#zoomOutButton {
    background-image: url("data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3Csvg%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%220%200%2024%2024%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%3Eicon%2Fmaterial%2Fview_zoom-out%3C%2Ftitle%3E%3Cg%20id%3D%22icon%2Fmaterial%2Fview_zoom-out%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22ic-baseline-minus%22%3E%3Cg%20id%3D%22Icon%22%20fill%3D%22%234D4D4D%22%3E%3Cpolygon%20id%3D%22Icon-Path%22%20points%3D%2219%2012.998%205%2012.998%205%2010.998%2019%2010.998%22%3E%3C%2Fpolygon%3E%3C%2Fg%3E%3Crect%20id%3D%22ViewBox%22%20fill-rule%3D%22nonzero%22%20x%3D%220%22%20y%3D%220%22%20width%3D%2224%22%20height%3D%2224%22%3E%3C%2Frect%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
}

#homeButton {
    background-image: url("data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%20encoding%3D%22UTF-8%22%3F%3E%3Csvg%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%220%200%2024%2024%22%20version%3D%221.1%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%3E%3Ctitle%3Eicon%2Fview-centered%3C%2Ftitle%3E%3Cg%20id%3D%22icon%2Fview-centered%22%20stroke%3D%22none%22%20stroke-width%3D%221%22%20fill%3D%22none%22%20fill-rule%3D%22evenodd%22%3E%3Cg%20id%3D%22Group-3%22%20transform%3D%22translate(2.000000%2C%204.000000)%22%20fill%3D%22%234D4D4D%22%3E%3Cpath%20d%3D%22M0%2C9%20L3%2C9%20L3%2C7%20L0%2C7%20L0%2C9%20Z%20M17%2C9%20L20.001%2C9%20L20.001%2C7%20L17%2C7%20L17%2C9%20Z%20M9%2C3%20L11%2C3%20L11%2C0%20L9%2C0%20L9%2C3%20Z%20M13%2C9%20L11%2C9%20L11%2C11%20L9%2C11%20L9%2C9%20L7%2C9%20L7%2C7%20L9%2C7%20L9%2C5%20L11%2C5%20L11%2C7%20L13%2C7%20L13%2C9%20Z%20M9%2C16%20L11%2C16%20L11%2C13%20L9%2C13%20L9%2C16%20Z%20M13%2C0%20L13%2C2%20L18%2C2%20L18%2C5%20L20%2C5%20L20%2C0%20L13%2C0%20Z%20M18%2C14%20L13%2C14%20L13%2C16%20L20%2C16%20L20%2C11%20L18%2C11%20L18%2C14%20Z%20M0%2C5%20L2%2C5%20L2%2C2%20L7%2C2%20L7%2C0%20L0%2C0%20L0%2C5%20Z%20M2%2C11%20L0%2C11%20L0%2C16%20L7%2C16%20L7%2C14%20L2%2C14%20L2%2C11%20Z%22%20id%3D%22Fill-1%22%3E%3C%2Fpath%3E%3C%2Fg%3E%3C%2Fg%3E%3C%2Fsvg%3E");
}

.enabledButton {
    background-image: url("data:image/svg+xml,%3Csvg%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20stroke%3D%22%234D4D4D%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3C!--%20Box%20outline%20--%3E%3Crect%20x%3D%223%22%20y%3D%223%22%20width%3D%2218%22%20height%3D%2218%22%20rx%3D%222%22%20ry%3D%222%22%20stroke-width%3D%222%22%2F%3E%3C!--%20Thicker%20checkmark%20--%3E%3Cpath%20d%3D%22M5.5%2012.5L10.5%2017.5L18.5%207.5%22%20stroke-width%3D%223%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E");
}

.enabledButton[disabled="true"] {
    background-image: url("data:image/svg+xml,%3Csvg%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Crect%20x%3D%223%22%20y%3D%223%22%20width%3D%2218%22%20height%3D%2218%22%20rx%3D%222%22%20ry%3D%222%22%20fill%3D%22none%22%20stroke%3D%22%234D4D4D%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%2F%3E%3C%2Fsvg%3E");
}

.inspectorButton {
    background-image: url("data:image/svg+xml,%3Csvg%20width%3D%2224px%22%20height%3D%2224px%22%20viewBox%3D%220%200%2024%2024%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%3Cg%20fill%3D%22none%22%20stroke%3D%22%234D4D4D%22%20stroke-width%3D%222%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3C!--%20Line%201%20--%3E%3Ccircle%20cx%3D%225%22%20cy%3D%227%22%20r%3D%221.5%22%20fill%3D%22%234D4D4D%22%20stroke%3D%22none%22%2F%3E%3Cline%20x1%3D%228%22%20y1%3D%227%22%20x2%3D%2219%22%20y2%3D%227%22%2F%3E%3C!--%20Line%202%20--%3E%3Ccircle%20cx%3D%225%22%20cy%3D%2212%22%20r%3D%221.5%22%20fill%3D%22%234D4D4D%22%20stroke%3D%22none%22%2F%3E%3Cline%20x1%3D%228%22%20y1%3D%2212%22%20x2%3D%2219%22%20y2%3D%2212%22%2F%3E%3C!--%20Line%203%20--%3E%3Ccircle%20cx%3D%225%22%20cy%3D%2217%22%20r%3D%221.5%22%20fill%3D%22%234D4D4D%22%20stroke%3D%22none%22%2F%3E%3Cline%20x1%3D%228%22%20y1%3D%2217%22%20x2%3D%2219%22%20y2%3D%2217%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E");
    display: none;
    pointer-events: none;
}

.inspectorButton[type="runner"] {
    display: inherit;
    pointer-events: all;
}

.cm-tooltip-lint {
   font-size: 12px;
}

.cm-tooltip-dependency {
    background-color: #66b;
    color: white;
    border: none;
    padding: 2px 7px;
    border-radius: 4px;
}

.cm-tooltip-cursor-wide {
   text-wrap: nowrap;
}
\`;`],
[`56`, `((css) => {
        const renkon = document.querySelector("#renkon");
        const style = document.createElement("style");
        style.id = "pad-css";
        style.textContent = css;
        renkon.querySelector("#pad-css")?.remove();
        renkon.appendChild(style);
    })(css);`],
[`57`, `const analyzed = ((windowContents, windowEnabled, trigger, showGraph) => {
    if (!showGraph) {return new Map()}
    if (trigger === null) {return new Map()}
    if (typeof trigger === "object" && trigger.id) {return new Map();}
    const programState = new Renkon.constructor(0);
    programState.setLog(() => {});

    const code = [...windowContents.map].filter(([id, editor]) => editor.state && windowEnabled.map.get(id)?.enabled).map(([id, editor]) => ({blockId: id, code: editor.state.doc.toString()}));
    try {
        programState.setupProgram(code);
    } catch(e) {
        console.log("Graph analyzer encountered an error in source code:");
        return new Map();
    }

    const nodes = new Map();
    for (let jsNode of programState.nodes.values()) {
        let ary = nodes.get(jsNode.blockId);
        if (!ary) {
            ary = [];
            nodes.set(jsNode.blockId, ary);
        }
        ary.push({inputs: jsNode.inputs, outputs: jsNode.outputs});
    }

    const exportedNames = new Map();
    const importedNames = new Map();
    for (let [id, subNodes] of nodes) {
        const exSet = new Set();
        exportedNames.set(id, exSet);

        const inSet = new Set();
        importedNames.set(id, inSet);

        for (let subNode of subNodes) {
            let outputs = subNode.outputs;
            if (outputs.length > 0 && !/^_[0-9]/.exec(outputs)) {
                exSet.add(outputs);
            }
            for (let inString of subNode.inputs) {
                if (!/^_[0-9]/.exec(inString)) {
                    inSet.add(inString);
                }
            }
        }
    }

    // {edgesOut: [{id: "defined name", dest: '2'}, ...],
    //  edgesIn: [{id: "defined name", origin: '2'}, ...]}
    const edges = new Map();

    for (let [id, _] of nodes) {
        const exporteds = exportedNames.get(id);
        const importeds = importedNames.get(id);

        const edgesOut = [];
        const edgesIn = [];
        const exports = new Set();

        for (let exported of exporteds) {
            for (let [destId, destSet] of importedNames) {
                if (destSet.has(exported) && id !== destId) {
                    edgesOut.push({id: exported, dest: destId});
                    exports.add(exported);
                }
            }
        }
        for (let imported of importeds) {
            for (let [sourceId, sourceSet] of exportedNames) {
                if (sourceSet.has(imported) && id !== sourceId) {
                    edgesIn.push({id: imported, origin: sourceId});
                }
            }
        }
        edges.set(id, {edgesOut, edgesIn, exports: [...exports]});
    }

    return edges;
})(windowContents, windowEnabled, Events.or(remove, hovered), showGraph === "showGraph");`],
[`58`, `const line = (p1, p2, color, label) => {
    let pl;
    let pr;
    if (p1.x < p2.x) {
        pl = p1;
        pr = p2;
    } else {
        pl = p2;
        pr = p1;
    }
    const c0 = \`\${pl.x} \${pl.y}\`;
    const c1 = \`\${pl.x + (pr.x - pl.x) * 0.5} \${pl.y + (pr.y - pl.y) * 0.2}\`;
    const c2 = \`\${pr.x - (pr.x - pl.x) * 0.2} \${pl.y + (pr.y - pl.y) * 0.6}\`;
    const c3 = \`\${pr.x} \${pr.y}\`;
    return html\`<path d="M \${c0} C \${c1} \${c2} \${c3}" stroke="\${color}" fill="transparent" stroke-width="2" stroke-linecap="round"></path><text x="\${p1.x + 5}" y="\${p1.y}">\${label}</text>\`;
};`],
[`59`, `const hovered = Events.receiver();`],
[`60`, `const hoveredB = Behaviors.keep(hovered);`],
[`61`, `const graph = ((positions, padView, analyzed, hoveredB, showGraph) => {
    if (hoveredB === null) {return [];}
    if (!showGraph) {return [];}

    const edges = analyzed.get(hoveredB);

    if (!edges) {return [];} // runner does not have edges

    const outEdges = edges.edgesOut.map((edge) => {
        const ind = edges.exports.indexOf(edge.id);
        let p1 = positions.map.get(hoveredB);
        p1 = {x: p1.x + p1.width, y: p1.y};
        p1 = {x: p1.x, y: p1.y + ind * 20 + 10};
        p1 = {x: p1.x * padView.scale + padView.x, y: p1.y * padView.scale + padView.y};
        let p2 = positions.map.get(edge.dest);
        p2 = {x: p2.x, y: p2.y + 10};
        p2 = {x: p2.x * padView.scale + padView.x, y: p2.y * padView.scale + padView.y};
        return line(p1, p2, "#d88", edge.id);
    });

    const inEdges = edges.edgesIn.map((edge) => {
        const exporter = analyzed.get(edge.origin);
        const ind = exporter.exports.indexOf(edge.id);
        let p1 = positions.map.get(edge.origin);
        p1 = {x: p1.x + p1.width, y: p1.y};
        p1 = {x: p1.x, y: p1.y + ind * 20 + 10};
        p1 = {x: p1.x * padView.scale + padView.x, y: p1.y * padView.scale + padView.y};
        let p2 = positions.map.get(hoveredB);
        p2 = {x: p2.x, y: p2.y + 10};
        p2 = {x: p2.x * padView.scale + padView.x, y: p2.y * padView.scale + padView.y};
        return line(p1, p2, "#88d", edge.id);
    });

    return html\`<svg viewBox="0 0 \${window.innerWidth} \${window.innerHeight}" xmlns="http://www.w3.org/2000/svg">\${outEdges}\${inEdges}</svg>\`;
})(positions, padView, analyzed, hoveredB, showGraph === "showGraph");`],
[`62`, `const _graphRender = render(graph, document.querySelector("#overlay"));`],
[`63`, `const windows = Behaviors.select(
    [],
    loadRequest, (now, data) => {
        console.log("windows loaded");
        return data.windows
    },
    newWindowRequest, (now, spec) => [...now, \`\${spec.id}\`],
    remove, (now, removeCommand) => now.filter((e) => e != removeCommand.id),
);`],
[`64`, `const windowTypes = Behaviors.select(
    {map: new Map()},
    loadRequest, (now, data) => {
        console.log("windowTypes loaded");
        return data.windowTypes;
    },
    newWindowRequest, (now, spec) => {
        now.map.set(\`\${spec.id}\`, spec.type);
        return {map: now.map};
    },
    Events.change(windows), (now, windows) => {
        const keys = [...now.map.keys()];
        const news = windows.filter((e) => !keys.includes(e));
        const olds = keys.filter((e) => !windows.includes(e));

        olds.forEach((id) => now.map.delete(\`\${id}\`));
        news.forEach((id) => now.map.set(\`\${id}\`, "code"));
        return {map: now.map};
    }
);`],
[`65`, `const positions = Behaviors.select(
    {map: new Map()},
    loadRequest, (now, data) => {
        console.log("positions loaded");
        return data.positions
    },
    Events.change(windowTypes), (now, types) => {
        const keys = [...now.map.keys()];
        const typeKeys = [...types.map.keys()];
        const news = typeKeys.filter((e) => !keys.includes(e));
        const olds = keys.filter((e) => !typeKeys.includes(e));

        const newX = (-padView.x + typeKeys.length * 5 + 40) / padView.scale;
        const newY = (-padView.y + typeKeys.length * 5 + 45) / padView.scale;

        const newWindow = (id, type) => {
            return {
                id,
                x: newX,
                y: newY,
                width: type === "code" ? 300 : 800,
                height: type === "code" ? 200 : 400
            }
        };
        olds.forEach((id) => now.map.delete(\`\${id}\`));
        news.forEach((id) => now.map.set(\`\${id}\`, newWindow(id, types.map.get(id))));
        return {map: now.map};
    },
    moveOrResize, (now, command) => {
        if (command.type === "move" || command.type === "resize") {
            const v = {...now.map.get(command.id), ...command};
            v.width = Math.max(120, v.width);
            v.height = Math.max(120, v.height);
            now.map.set(command.id, v);
            return {map: now.map};
        }
        return now;
    },
);`],
[`66`, `const findMax = (map)  => {
    let maxId = -1;
    let max = -1;
    for (let [id, value] of map) {
        if (value > max) {
            maxId = id;
            max = value;
        }
    }
    return {maxId, max};
};`],
[`67`, `const zIndex = Behaviors.select(
    {map: new Map()},
    loadRequest, (now, data) => {
        console.log("zIndex loaded");
        if (data.zIndex) return data.zIndex;
        return {map: new Map(data.windows.map((w, i) => [w, i + 100]))};
    },
    Events.change(windows), (now, command) => {
        const keys = [...now.map.keys()];
        const news = command.filter((e) => !keys.includes(e));
        const olds = keys.filter((e) => !command.includes(e));

        const {maxId:_maxId, max} = findMax(now.map);
        let z = max < 0 ? 100 : max + 1;
        olds.forEach((id) => now.map.delete(id));
        news.forEach((id) => now.map.set(id, z++));
        return {map: now.map};
    },
    moveOrResize, (now, command) => {
        if (command.type === "move") {
            const z = now.map.get(command.id);

            const {maxId, max} = findMax(now.map);
            if (maxId !== command.id) {
                now.map.set(maxId, z);
                now.map.set(command.id, max);
            }
            return {map: now.map};
        }
        return now
    },
);`],
[`68`, `const titles = Behaviors.select(
    {map: new Map()},
    loadRequest, (now, loaded) => {
        console.log("titles loaded");
        return loaded.titles || {map: new Map()};
    },
    Events.change(windows), (now, command) => {
        const keys = [...now.map.keys()];
        const news = command.filter((e) => !keys.includes(e));
        const olds = keys.filter((e) => !command.includes(e));

        olds.forEach((id) => now.map.delete(id));
        news.forEach((id) => now.map.set(id, {id, state: false, title: "untitled"}));
        return {map: now.map};
    },
    titleEditChange, (now, change) => {
        const id = change.id;
        const v = {...now.map.get(id), ...change};
        now.map.set(id, v);
        return {map: now.map};
    }
);`],
[`69`, `const windowEnabled = Behaviors.select(
    {map: new Map()},
    loadRequest, (now, loaded) => {
        console.log("windowEnabled loaded");
        return loaded.windowEnabled || {map: new Map()};
    },
    Events.change(windows), (now, command) => {
        const keys = [...now.map.keys()];
        const news = command.filter((e) => !keys.includes(e));
        const olds = keys.filter((e) => !command.includes(e));

        olds.forEach((id) => now.map.delete(id));
        news.forEach((id) => now.map.set(id, {id, enabled: true}));
        return {map: now.map};
    },
    enabledChange, (now, change) => {
        // console.log("enabledChange", change);
        const id = change.id;
        const v = {...now.map.get(id), ...change};
        now.map.set(id, v);
        return {map: now.map};
    }
);`],
[`70`, `const windowContents = Behaviors.select(
    {map: new Map()},
    loadRequest, (now, loaded) => {
        for (let editor of now.map.values()) {
            editor.dom.remove();
        }
        now.map.clear();

        for (let [id, type] of loaded.windowTypes.map) {
            let elem;
            if (type === "code") {
                elem = newEditor(id, loaded.code.get(id));
            } else {
                elem = newRunner(id);
            }
            now.map.set(id, elem);
        }
        return {map: now.map};
    },
    Events.change(windowTypes), (now, types) => {
        const keys = [...now.map.keys()];
        const typeKeys = [...types.map.keys()];
        const news = typeKeys.filter((e) => !keys.includes(e));
        const olds = keys.filter((e) => !typeKeys.includes(e));
        olds.forEach((id) => {
            const editor = now.map.get(id);
            editor.dom.remove();
            now.map.delete(id)
        });
        news.forEach((id) => {
            const type = types.map.get(id);
            now.map.set(id, type === "code" ? newEditor(id) : newRunner(id));
        });
        return {map: now.map};
    }
);`],
[`71`, `const init = Events.once("code");`],
[`72`, `const newId = Events.select(
    0,
    loadRequest, (now, request) => {
        const max = Math.max(...request.windows.map((w) => Number.parseInt(w)));
        return max;
    },
    Events.or(addCode, addRunner, init), (now, _type) => now + 1
);`],
[`73`, `const newWindowRequest = Events.change({id: newId, type: Events.or(addCode, addRunner, init), padView});`],
[`74`, `const padView = Behaviors.select(
    {x: 0, y: 0, scale: 1},
    padViewChange, (now, view) => {
        let {x, y, scale} = view;

        if (scale < 0.1) {scale = 0.1;}
        if (scale > 20) {scale = 20;}
        return {...now, ...{x, y, scale}};
    }
);`],
[`75`, `const padTitle = Behaviors.select(
    "untitled",
    loadRequest, (now, data) => {
        console.log("padTitle loaded");
        return data.padTitle || "untitled"
    },
    titleChange, (now, request) => request
);`],
[`76`, `const titleChange = Events.observe((notify) => {
    const change = (evt) => {
        notify(evt.target.value);
    };

    renkon.querySelector("#padTitle").addEventListener("input", change);
    return () => {renkon.querySelector("#padTitle").removeEventListener("change", change);}
});`],
[`77`, `const _padTitleUpdater = ((padTitle) => {
    if (renkon.querySelector("#padTitle").value !== padTitle) {
        renkon.querySelector("#padTitle").value = padTitle;
    }
})(padTitle);`],
[`78`, `const {h, html, render} = import("./preact.standalone.module.js");`],
[`79`, `const renkon = (() => {
    const renkon = document.createElement("div");
    renkon.id = "renkon";
    renkon.innerHTML = \`
<div id="buttonBox">
<input class="menuButton" id="padTitle"></input>
<button class="menuButton" id="addCodeButton">code</button>
<button class="menuButton" id="addRunnerButton">runner</button>
<div class="spacer"></div>
<button class="menuButton" id="showGraph">show graph</button>
<button class="menuButton" id="saveButton">save</button>
<button class="menuButton" id="loadButton">load</button>
</div>
<div id="pad"><div id="mover"></div></div>
<div id="overlay"></div>
<div id="navigationBox">
<div class="navigationButton"><div id="homeButton" class="navigationButtonImage"></div></div>
<div class="navigationButton with-border"><div id="zoomInButton" class="navigationButtonImage"></div></div>
<div class="navigationButton with-border"><div id="zoomOutButton" class="navigationButtonImage"></div></div>
</div>

\`.trim();

    document.body.querySelector("#renkon")?.remove();
    document.body.appendChild(renkon);
    return renkon;
})();`],
[`80`, `function stringifyInner(node, seen) {
    if (node === undefined) return undefined;
    if (typeof node === 'number') return Number.isFinite(node) ? \`\${node}\` : 'null';
    if (typeof node !== 'object') return JSON.stringify(node, null, 4);

    let out;
    if (Array.isArray(node)) {
        out = '[';
        for (let i = 0; i < node.length; i++) {
            if (i > 0) out += ',';
            out += stringifyInner(node[i], seen) || 'null';
        }
        return out + ']';
    }

    if (node === null) return 'null';

    if (seen.has(node)) {
        throw new TypeError('Converting circular structure to JSON');
    }

    seen.add(node);

    if (node.constructor === window.Map) {
        let replacement = {__map: true, values: [...node]};
        return stringifyInner(replacement, seen);
    }

    if (node.constructor === window.Set) {
        let replacement = {__set: true, values: [...node]};
        return stringifyInner(replacement, seen);
    }

    let keys = Object.keys(node).sort();
    out = '';
    for (let i = 0; i < keys.length; i++) {
        let key = keys[i];
        let value = stringifyInner(node[key], seen, out);
        if (!value) continue;
        if (out !== '') out += ',\\n';
        out += JSON.stringify(key) + ':' + value;
    }
    seen.delete(node);
    return '{' + out + '}';
}`],
[`81`, `function stringify(obj) {
    let seen = new Set();
    return stringifyInner(obj, seen);
}`],
[`82`, `function parse(string) {
    return JSON.parse(string, (_key, value) => {
        if (typeof value === "object" && value !== null && value.__map) {
            return new Map(value.values);
        } else if (typeof value === "object" && value !== null && value.__set) {
            return new Set(value.values);
        }
        return value;
    });
}`],
[`83`, `function stringifyCodeMap(map) {
    function replace(str) {
        return str.replaceAll("\\\\", "\\\\\\\\").replaceAll("\`", "\\\\\`").replaceAll("\$", "\\\\\$");
    }

    return "\\n{__codeMap: true, value: " + "[" +
        [...map].map(([key, value]) => ("[" + "\`" + replace(key) + "\`" + ", " + "\`" +  replace(value) + "\`" + "]")).join(",\\n") + "]" + "}"
}`],
[`84`, `function parseCodeMap(string) {
    const array = eval("(" + string + ")");
    return new Map(array.value);
}`],
[`85`, `const newEditor = (id, doc) => {
    const mirror = window.CodeMirror;

    const config = {
        // eslint configuration
        languageOptions: {
            globals: mirror.globals,
            parserOptions: {
                ecmaVersion: 2022,
                sourceType: "module",
            },
        },
        rules: {
        },
    };

    const getDecl = (state, pos) => {
        const showDependency = Renkon.resolved.get("showGraph")?.value;
        if (!showDependency || showDependency !== "showDeps") {return;}
        let decls;
        try {
            decls = Renkon.findDecls(state.doc.toString());
        } catch(e) {
            console.log("Dependency analyzer encountered an error in source code:");
            return;
        }
        const head = pos !== undefined ? pos : state.selection.ranges[0]?.head;
        if (typeof head !== "number") {return;}
        const decl = decls.find((d) => d.start <= head && head < d.end);
        if (!decl) {return;}
        const programState = new Renkon.constructor(0);
        programState.setLog(() => {});
        programState.setupProgram([decl.code]);
        const keys = [...programState.nodes.keys()];
        const last = keys[keys.length - 1];
        const deps = [];
        for (const k of keys) {
            const is = programState.nodes.get(k).inputs;
            deps.push(...is.filter((n) => !/_[0-9]/.exec(n)));
        }
        return {deps, name: last}
    }

    const wordHover = mirror.hoverTooltip((view, pos, _side) => {
        let node = getDecl(view.state, pos);
        if (!node) return null;
        const {deps, name} = node;
        return {
            pos,
            above: true,
            create() {
                let dom = document.createElement("div");
                dom.textContent = \`\${deps} -> \${name}\`;
                dom.className = "cm-tooltip-dependency cm-tooltip-cursor-wide";
                return {dom};
            }
        };
    });

    const editor = new mirror.EditorView({
        doc: doc || \`console.log("hello")\`,
        extensions: [
            mirror.basicSetup,
            mirror.javascript({typescript: true}),
            mirror.EditorView.lineWrapping,
            mirror.EditorView.editorAttributes.of({"class": "editor"}),
            mirror.keymap.of([mirror.indentWithTab]),
            mirror.linter(mirror.esLint(new mirror.eslint.Linter(), config)),
            wordHover,
        ],
    });
    editor.dom.id = \`\${id}-editor\`;
    return editor;
};`],
[`86`, `const newRunner = (id) => {
    const runnerIframe = document.createElement("iframe");
    runnerIframe.srcdoc = \`
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <style>
.dock {
position: fixed;
top: 0px;
right: 0px;
width: 30%;
height: 80%;
display: flex;
box-shadow: 10px 10px 5px #4d4d4d, -10px -10px 5px #dddddd;
transition: left 0.5s;
background-color: white;
z-index: 1000000;
overflow-y: scroll;
}

.dock #inspector {
flex-grow: 1;
margin: 0px 20px 0px 20px;
background-color: #ffffff;
border: 1px solid black;
}

</style>
    <script type="module">
        import {ProgramState, CodeMirror, newInspector} from "./renkon-web.js";
        window.thisProgramState = new ProgramState(0);
        window.CodeMirror = CodeMirror;
        window.newInspector = newInspector;

        window.onmessage = (evt) => {
            if (evt.data && Array.isArray(evt.data.code)) {
                window.thisProgramState.updateProgram(evt.data.code, evt.data.path);
                if (window.thisProgramState.evaluatorRunning === 0) {
                    window.thisProgramState.evaluator();
                }
            }
            if (evt.data && typeof evt.data.inspector === "boolean") {
                if (window.thisProgramState) {
                    if (document.body.querySelector(".dock")) {
                        document.body.querySelector(".dock").remove();
                        return;
                    }
                    const dock = document.createElement("div");
                    dock.classList.add("dock");
                    const dom = document.createElement("div");
                    dom.id = "renkonInspector";

                    dock.appendChild(dom);
                    document.body.appendChild(dock);
                    const result = thisProgramState.order.map((id) => {
                        return [id, thisProgramState.resolved.get(id)]
                    });
                    newInspector(Object.fromEntries(result), dom);
               }
            }
        };
    </script>
</head>
<body></body>
</html>\`;
    runnerIframe.classList = "runnerIframe";
    runnerIframe.id = \`runner-\${id}\`;
    return {dom: runnerIframe};
};`]]}